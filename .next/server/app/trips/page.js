(()=>{var e={};e.id=633,e.ids=[633],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},6570:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>o}),r(5331),r(9116),r(5866);var s=r(3191),a=r(8716),i=r(7922),l=r.n(i),n=r(5231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);r.d(t,c);let o=["",{children:["trips",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5331)),"D:\\React Native\\admin-dashboard\\app\\trips\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9116)),"D:\\React Native\\admin-dashboard\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\React Native\\admin-dashboard\\app\\trips\\page.tsx"],u="/trips/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/trips/page",pathname:"/trips",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},1441:(e,t,r)=>{Promise.resolve().then(r.bind(r,4070))},4070:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>M});var s=r(326),a=r(5510),i=r(490),l=r(2817),n=r(1696),c=r(2226),o=r(5353),d=r(7577);let u={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"};var p=r(4082),x=d.forwardRef(function(e,t){return d.createElement(p.Z,(0,o.Z)({},e,{ref:t,icon:u}))}),h=r(9636),m=r(6709),y=r(2170),g=r(2379),f=r(3204),j=r(8506),v=r(1063),Z=r(4139),b=r(8106),w=r(784),k=r(1135),P=r(5676),_=r(3155),S=r(7214),C=r(9270),A=r(5047),T=r(2972);r(3212);var z=r(1973);let{Title:q,Text:D}=h.default;function M(){let{user:e,loading:t,isAdmin:r}=(0,z.a)(),o=(0,A.useRouter)(),[u,p]=(0,d.useState)([]),[h,M]=(0,d.useState)([]),[I,$]=(0,d.useState)(!0),[N,E]=(0,d.useState)(!1),[R,F]=(0,d.useState)(null),[B]=m.Z.useForm(),L=async()=>{try{$(!0);let[e,t]=await Promise.all([(0,T.cQ)(),(0,T.Fv)()]);if(e.error)throw e.error;if(t.error)throw t.error;let r=(e.data||[]).map(e=>({...e,buses:Array.isArray(e.buses)?e.buses[0]:e.buses,driver:Array.isArray(e.driver)?e.driver[0]:e.driver})),s=(t.data||[]).map(e=>({...e,buses:Array.isArray(e.buses)?e.buses[0]:e.buses,driver:Array.isArray(e.driver)?e.driver[0]:e.driver}));p(r),M(s)}catch(e){console.error("Error loading trips data:",e),y.ZP.error("Failed to load trips data")}finally{$(!1)}},G=async(e,t,r)=>{try{let{error:r}=await (0,T.tM)(e,t);if(r)throw r;y.ZP.success(`Trip status updated to ${t}`),L()}catch(e){console.error("Error updating trip status:",e),y.ZP.error("Failed to update trip status")}},K=async e=>{if(R)try{let{error:e}=await (0,T.tM)(R.id,"cancelled");if(e)throw e;y.ZP.success("Trip cancelled successfully"),E(!1),F(null),B.resetFields(),L()}catch(e){console.error("Error cancelling trip:",e),y.ZP.error("Failed to cancel trip")}},H=e=>{F(e),E(!0)},O=e=>{let t={waiting:{color:"blue",text:"Waiting"},ongoing:{color:"green",text:"Ongoing"},completed:{color:"success",text:"Completed"},cancelled:{color:"red",text:"Cancelled"}}[e];return s.jsx(g.Z,{color:t.color,children:t.text})},Q=e=>e?new Date(e).toLocaleString():"N/A",J=[{title:"Trip ID",dataIndex:"id",key:"id",render:e=>(0,s.jsxs)(D,{code:!0,style:{fontSize:"12px"},children:[e.slice(0,8),"..."]})},{title:"Bus",key:"bus",render:e=>(0,s.jsxs)("div",{children:[s.jsx(D,{strong:!0,children:e.buses.plate_number}),s.jsx("br",{}),s.jsx(D,{type:"secondary",style:{fontSize:"12px"},children:e.buses.routes.name})]})},{title:"Driver",key:"driver",render:e=>(0,s.jsxs)("div",{children:[s.jsx(D,{children:e.driver.fullName}),s.jsx("br",{}),s.jsx(D,{type:"secondary",style:{fontSize:"12px"},children:e.driver.contact_number})]})},{title:"Passengers",key:"passengers",render:e=>{let t=e.trip_passengers.filter(e=>"boarded"===e.status).length;return(0,s.jsxs)("div",{children:[(0,s.jsxs)(D,{children:[t,"/",e.buses.capacity]}),s.jsx("br",{}),(0,s.jsxs)(D,{type:"secondary",style:{fontSize:"12px"},children:[Math.round(t/e.buses.capacity*100),"% full"]})]})}},{title:"Started At",dataIndex:"started_at",key:"started_at",render:e=>Q(e)},{title:"Status",dataIndex:"status",key:"status",render:e=>O(e)},{title:"Actions",key:"actions",render:e=>(0,s.jsxs)(f.Z,{children:[s.jsx(j.ZP,{type:"link",icon:s.jsx(a.Z,{}),onClick:()=>{y.ZP.info("Trip details feature coming soon")},children:"Details"}),"ongoing"===e.status&&s.jsx(j.ZP,{type:"link",onClick:()=>G(e.id,"completed"),children:"Complete"}),"completed"!==e.status&&"cancelled"!==e.status&&s.jsx(j.ZP,{type:"link",danger:!0,onClick:()=>H(e),children:"Cancel"})]})}],V=[{title:"Trip ID",dataIndex:"id",key:"id",render:e=>(0,s.jsxs)(D,{code:!0,style:{fontSize:"12px"},children:[e.slice(0,8),"..."]})},{title:"Bus",key:"bus",render:e=>(0,s.jsxs)("div",{children:[s.jsx(D,{strong:!0,children:e.buses.plate_number}),s.jsx("br",{}),s.jsx(D,{type:"secondary",style:{fontSize:"12px"},children:e.buses.routes.name})]})},{title:"Driver",key:"driver",render:e=>s.jsx(D,{children:e.driver.fullName})},{title:"Started At",dataIndex:"started_at",key:"started_at",render:e=>Q(e)},{title:"Ended At",dataIndex:"ended_at",key:"ended_at",render:e=>Q(e)},{title:"Duration",key:"duration",render:e=>{if(!e.started_at||!e.ended_at)return"N/A";let t=new Date(e.started_at),r=Math.round((new Date(e.ended_at).getTime()-t.getTime())/6e4);return`${r} min`}},{title:"Status",dataIndex:"status",key:"status",render:e=>O(e)}],W=u.filter(e=>"waiting"===e.status).length,X=u.filter(e=>"ongoing"===e.status).length,U=h.filter(e=>"completed"===e.status).length,Y=h.filter(e=>"cancelled"===e.status).length;return t||I?s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx(v.Z,{size:"large"})}):(0,s.jsxs)("div",{className:"admin-layout",children:[(0,s.jsxs)("div",{className:"admin-header",children:[s.jsx("div",{className:"admin-logo",children:"Miniway Admin Dashboard"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[s.jsx(j.ZP,{onClick:()=>o.push("/"),children:"Dashboard"}),s.jsx(j.ZP,{onClick:L,icon:s.jsx(i.Z,{}),children:"Refresh"})]})]}),(0,s.jsxs)("div",{className:"admin-content",children:[s.jsx(Z.Z,{gutter:[16,16],style:{marginBottom:"24px"},children:(0,s.jsxs)(b.Z,{span:24,children:[s.jsx(q,{level:2,children:"Trip Management"}),s.jsx(D,{type:"secondary",children:"Monitor active trips and view trip history"})]})}),(0,s.jsxs)(Z.Z,{gutter:[16,16],style:{marginBottom:"24px"},children:[s.jsx(b.Z,{xs:24,sm:12,md:6,children:s.jsx(w.Z,{children:s.jsx(k.Z,{title:"Waiting Trips",value:W,prefix:s.jsx(l.Z,{style:{color:"#1890ff"}}),valueStyle:{color:"#1890ff"}})})}),s.jsx(b.Z,{xs:24,sm:12,md:6,children:s.jsx(w.Z,{children:s.jsx(k.Z,{title:"Ongoing Trips",value:X,prefix:s.jsx(n.Z,{style:{color:"#52c41a"}}),valueStyle:{color:"#52c41a"}})})}),s.jsx(b.Z,{xs:24,sm:12,md:6,children:s.jsx(w.Z,{children:s.jsx(k.Z,{title:"Completed Trips",value:U,prefix:s.jsx(c.Z,{style:{color:"#13c2c2"}}),valueStyle:{color:"#13c2c2"}})})}),s.jsx(b.Z,{xs:24,sm:12,md:6,children:s.jsx(w.Z,{children:s.jsx(k.Z,{title:"Cancelled Trips",value:Y,prefix:s.jsx(x,{style:{color:"#ff4d4f"}}),valueStyle:{color:"#ff4d4f"}})})})]}),s.jsx(w.Z,{children:s.jsx(P.Z,{defaultActiveKey:"active",items:[{key:"active",label:`Active Trips (${u.length})`,children:s.jsx(_.Z,{columns:J,dataSource:u,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} trips`},scroll:{x:1e3}})},{key:"history",label:`History (${h.length})`,children:s.jsx(_.Z,{columns:V,dataSource:h,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} trips`},scroll:{x:1e3}})}]})}),s.jsx(S.Z,{title:"Cancel Trip",open:N,onCancel:()=>{E(!1),F(null),B.resetFields()},footer:null,children:(0,s.jsxs)(m.Z,{form:B,layout:"vertical",onFinish:K,children:[s.jsx(m.Z.Item,{label:"Trip Details",name:"trip",initialValue:R?`${R.buses.plate_number} - ${R.buses.routes.name}`:"",children:s.jsx(C.default,{disabled:!0})}),s.jsx(m.Z.Item,{label:"Cancellation Reason",name:"reason",rules:[{required:!0,message:"Please provide a reason for cancellation!"}],children:s.jsx(C.default.TextArea,{rows:4,placeholder:"Enter the reason for cancelling this trip..."})}),s.jsx(m.Z.Item,{children:(0,s.jsxs)(f.Z,{children:[s.jsx(j.ZP,{type:"primary",htmlType:"submit",danger:!0,children:"Cancel Trip"}),s.jsx(j.ZP,{onClick:()=>{E(!1),F(null),B.resetFields()},children:"Keep Trip"})]})})]})})]})]})}},2226:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(5353),a=r(7577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};var l=r(4082);let n=a.forwardRef(function(e,t){return a.createElement(l.Z,(0,s.Z)({},e,{ref:t,icon:i}))})},2817:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(5353),a=r(7577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"};var l=r(4082);let n=a.forwardRef(function(e,t){return a.createElement(l.Z,(0,s.Z)({},e,{ref:t,icon:i}))})},5331:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>n});var s=r(8570);let a=(0,s.createProxy)(String.raw`D:\React Native\admin-dashboard\app\trips\page.tsx`),{__esModule:i,$$typeof:l}=a;a.default;let n=(0,s.createProxy)(String.raw`D:\React Native\admin-dashboard\app\trips\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[206,399,454,371,817,214,699,222],()=>r(6570));module.exports=s})();