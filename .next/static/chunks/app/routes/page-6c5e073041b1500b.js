(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[316],{1269:function(e,t,r){Promise.resolve().then(r.bind(r,9204))},9204:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return z}});var s=r(7437),n=r(2988),a=r(2265),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 289.1a362.49 362.49 0 00-79.9-115.7 370.83 370.83 0 00-118.2-77.8C610.7 76.6 562.1 67 512 67c-50.1 0-98.7 9.6-144.5 28.5-44.3 18.3-84 44.5-118.2 77.8A363.6 363.6 0 00169.4 289c-19.5 45-29.4 92.8-29.4 142 0 70.6 16.9 140.9 50.1 208.7 26.7 54.5 64 107.6 111 158.1 80.3 86.2 164.5 138.9 188.4 153a43.9 43.9 0 0022.4 6.1c7.8 0 15.5-2 22.4-6.1 23.9-14.1 108.1-66.8 188.4-153 47-50.4 84.3-103.6 111-158.1C867.1 572 884 501.8 884 431.1c0-49.2-9.9-97-29.4-142zM512 880.2c-65.9-41.9-300-207.8-300-449.1 0-77.9 31.1-151.1 87.6-206.3C356.3 169.5 431.7 139 512 139s155.7 30.5 212.4 85.9C780.9 280 812 353.2 812 431.1c0 241.3-234.1 407.2-300 449.1zm0-617.2c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 551c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 439c0-29.9 11.7-58 32.8-79.2C454 338.6 482.1 327 512 327c29.9 0 58 11.6 79.2 32.8C612.4 381 624 409.1 624 439c0 29.9-11.6 58-32.8 79.2z"}}]},name:"environment",theme:"outlined"},d=r(5636),o=a.forwardRef(function(e,t){return a.createElement(d.Z,(0,n.Z)({},e,{ref:t,icon:l}))}),i=r(4816),c=r(7645),u=r(6115),h=r(9569),x=r(5325),m=r(8556),f=r(8569),j=r(3288),Z=r(8256),y=r(8816),g=r(8421),p=r(7733),v=r(5381),w=r(8357),C=r(6e3),R=r(9874),k=r(6463),P=r(8643),_=r(8661);let{Title:A,Text:E}=h.default,{TextArea:S}=x.default;function z(){let{user:e,loading:t,isAdmin:r}=(0,_.a)(),n=(0,k.useRouter)(),[l,d]=(0,a.useState)([]),[h,z]=(0,a.useState)(!0),[b,F]=(0,a.useState)(!1),[I,N]=(0,a.useState)(null),[M]=m.Z.useForm();(0,a.useEffect)(()=>{t||e?t||!e||r||(f.ZP.error("Access denied. Admin privileges required."),n.push("/")):n.push("/login")},[e,t,r,n]),(0,a.useEffect)(()=>{e&&r&&D()},[e,r]);let D=async()=>{try{z(!0);let{data:e,error:t}=await (0,P._c)();t?(console.error("Error loading routes:",t),f.ZP.error("Failed to load routes"),d([])):d(e||[])}catch(e){console.error("Error loading routes:",e),f.ZP.error("Failed to load routes"),d([])}finally{z(!1)}},q=async e=>{try{if(I){let{error:t}=await (0,P.fq)(I.id,e);if(t)throw t;f.ZP.success("Route updated successfully")}else{let{error:t}=await (0,P.ot)(e);if(t)throw t;f.ZP.success("Route created successfully")}F(!1),N(null),M.resetFields(),D()}catch(e){console.error("Error saving route:",e),f.ZP.error("Failed to save route")}},L=e=>{N(e),M.setFieldsValue({name:e.name,start_address:e.start_address,end_address:e.end_address}),F(!0)},T=async e=>{try{let{error:t}=await (0,P.qW)(e);if(t)throw t;f.ZP.success("Route deleted successfully"),D()}catch(e){console.error("Error deleting route:",e),f.ZP.error("Failed to delete route")}},B=e=>new Date(e).toLocaleString(),O=[{title:"Route Name",dataIndex:"name",key:"name",render:e=>(0,s.jsx)(E,{strong:!0,style:{color:"#1890ff"},children:e})},{title:"Start Address",dataIndex:"start_address",key:"start_address",render:e=>(0,s.jsxs)("div",{children:[(0,s.jsx)(o,{style:{color:"#52c41a",marginRight:"8px"}}),(0,s.jsx)(E,{children:e})]})},{title:"End Address",dataIndex:"end_address",key:"end_address",render:e=>(0,s.jsxs)("div",{children:[(0,s.jsx)(o,{style:{color:"#ff4d4f",marginRight:"8px"}}),(0,s.jsx)(E,{children:e})]})},{title:"Created",dataIndex:"created_at",key:"created_at",render:e=>B(e)},{title:"Actions",key:"actions",render:e=>(0,s.jsxs)(j.Z,{children:[(0,s.jsx)(Z.ZP,{type:"link",onClick:()=>L(e),children:"Edit"}),(0,s.jsx)(Z.ZP,{type:"link",danger:!0,onClick:()=>{y.Z.confirm({title:"Delete Route",content:'Are you sure you want to delete the route "'.concat(e.name,'"?'),onOk:()=>T(e.id)})},children:"Delete"})]})}];return t||h?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,s.jsx)(g.Z,{size:"large"})}):(0,s.jsxs)("div",{className:"admin-layout",children:[(0,s.jsxs)("div",{className:"admin-header",children:[(0,s.jsx)("div",{className:"admin-logo",children:"Miniway Admin Dashboard"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,s.jsx)(Z.ZP,{onClick:()=>n.push("/"),children:"Dashboard"}),(0,s.jsx)(Z.ZP,{onClick:D,icon:(0,s.jsx)(i.Z,{}),children:"Refresh"})]})]}),(0,s.jsxs)("div",{className:"admin-content",children:[(0,s.jsx)(p.Z,{gutter:[16,16],style:{marginBottom:"24px"},children:(0,s.jsxs)(v.Z,{span:24,children:[(0,s.jsx)(A,{level:2,children:"Route Management"}),(0,s.jsx)(E,{type:"secondary",children:"Manage transportation routes and their details"})]})}),(0,s.jsxs)(p.Z,{gutter:[16,16],style:{marginBottom:"24px"},children:[(0,s.jsx)(v.Z,{xs:24,sm:12,md:6,children:(0,s.jsx)(w.Z,{children:(0,s.jsx)(C.Z,{title:"Total Routes",value:l.length,prefix:(0,s.jsx)(c.Z,{style:{color:"#1890ff"}}),valueStyle:{color:"#1890ff"}})})}),(0,s.jsx)(v.Z,{xs:24,sm:12,md:6,children:(0,s.jsx)(w.Z,{children:(0,s.jsx)(C.Z,{title:"Active Routes",value:l.length,prefix:(0,s.jsx)(c.Z,{style:{color:"#52c41a"}}),valueStyle:{color:"#52c41a"}})})})]}),(0,s.jsx)(w.Z,{title:"Transportation Routes",extra:(0,s.jsx)(Z.ZP,{type:"primary",icon:(0,s.jsx)(u.Z,{}),onClick:()=>{N(null),M.resetFields(),F(!0)},children:"Add Route"}),children:(0,s.jsx)(R.Z,{columns:O,dataSource:l,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," routes")},scroll:{x:800}})}),(0,s.jsx)(y.Z,{title:I?"Edit Route":"Add New Route",open:b,onCancel:()=>{F(!1),N(null),M.resetFields()},footer:null,children:(0,s.jsxs)(m.Z,{form:M,layout:"vertical",onFinish:q,children:[(0,s.jsx)(m.Z.Item,{label:"Route Name",name:"name",rules:[{required:!0,message:"Please enter route name!"}],children:(0,s.jsx)(x.default,{placeholder:"e.g., Downtown to Airport"})}),(0,s.jsx)(m.Z.Item,{label:"Start Address",name:"start_address",rules:[{required:!0,message:"Please enter start address!"}],children:(0,s.jsx)(S,{rows:2,placeholder:"e.g., 123 Main Street, Downtown"})}),(0,s.jsx)(m.Z.Item,{label:"End Address",name:"end_address",rules:[{required:!0,message:"Please enter end address!"}],children:(0,s.jsx)(S,{rows:2,placeholder:"e.g., International Airport Terminal 1"})}),(0,s.jsx)(m.Z.Item,{children:(0,s.jsxs)(j.Z,{children:[(0,s.jsx)(Z.ZP,{type:"primary",htmlType:"submit",children:I?"Update Route":"Create Route"}),(0,s.jsx)(Z.ZP,{onClick:()=>{F(!1),N(null),M.resetFields()},children:"Cancel"})]})})]})})]})]})}},7645:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var s=r(2988),n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm198.4-588.1a32 32 0 00-24.5.5L414.9 415 296.4 686c-3.6 8.2-3.6 17.5 0 25.7 3.4 7.8 9.7 13.9 17.7 17 3.8 1.5 7.7 2.2 11.7 2.2 4.4 0 8.7-.9 12.8-2.7l271-118.6 118.5-271a32.06 32.06 0 00-17.7-42.7zM576.8 534.4l26.2 26.2-42.4 42.4-26.2-26.2L380 644.4 447.5 490 422 464.4l42.4-42.4 25.5 25.5L644.4 380l-67.6 154.4zM464.4 422L422 464.4l25.5 25.6 86.9 86.8 26.2 26.2 42.4-42.4-26.2-26.2-86.8-86.9z"}}]},name:"compass",theme:"outlined"},l=r(5636),d=n.forwardRef(function(e,t){return n.createElement(l.Z,(0,s.Z)({},e,{ref:t,icon:a}))})}},function(e){e.O(0,[377,943,866,403,556,689,882,971,23,744],function(){return e(e.s=1269)}),_N_E=e.O()}]);